@model DAMH.Models.Chapter

@{
    ViewData["Title"] = Model.Title;
    var isAdminView = ViewBag.IsAdminView ?? false;
    var previousChapterId = ViewBag.PreviousChapterId as int?;
    var nextChapterId = ViewBag.NextChapterId as int?;
    var allChapters = ViewBag.AllChapters as List<DAMH.Models.Chapter>;
}

<div class="container-fluid mt-3">
    <div class="reading-toolbar sticky-top bg-white shadow-sm py-3 mb-4" style="z-index: 1000;">
        <div class="container">
            <div class="row align-items-center g-2">
                <div class="col-auto">
                    @if (isAdminView)
                    {
                        <a asp-controller="Admin" asp-action="ViewBookChapters" asp-route-bookId="@Model.BookId" class="btn btn-outline-danger">
                            <i class="bi bi-arrow-left"></i> Về trang Admin
                        </a>
                    }
                    else
                    {
                        <a asp-controller="Home" asp-action="Details" asp-route-id="@Model.BookId" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-left"></i> Mục lục
                        </a>
                    }
                </div>

                <div class="col-md-4">
                    <select class="form-select" onchange="window.location.href='@Url.Action("ViewChapter", "Reading")?chapterId=' + this.value + '&isAdminView=@isAdminView'">
                        @if (allChapters != null)
                        {
                            foreach (var chapter in allChapters)
                            {
                                <option value="@chapter.ChapterId" selected="@(chapter.ChapterId == Model.ChapterId)">
                                    Chương @chapter.ChapterOrder: @chapter.Title
                                </option>
                            }
                        }
                    </select>
                </div>

                <div class="col-auto">
                    @if (previousChapterId.HasValue)
                    {
                        <a asp-action="ViewChapter" asp-route-chapterId="@previousChapterId" asp-route-isAdminView="@isAdminView" class="btn btn-outline-secondary">
                            <i class="bi bi-chevron-left"></i> Trước
                        </a>
                    }
                    else
                    {
                        <button class="btn btn-outline-secondary" disabled><i class="bi bi-chevron-left"></i> Trước</button>
                    }
                </div>

                <div class="col-auto">
                    @if (nextChapterId.HasValue)
                    {
                        <a asp-action="ViewChapter" asp-route-chapterId="@nextChapterId" asp-route-isAdminView="@isAdminView" class="btn btn-primary">
                            Sau <i class="bi bi-chevron-right"></i>
                        </a>
                    }
                    else
                    {
                        <button class="btn btn-secondary" disabled>Sau <i class="bi bi-chevron-right"></i></button>
                    }
                </div>

                <div class="col-auto ms-auto">
                    <button class="btn btn-outline-danger" onclick="alert('Đã thêm vào yêu thích!')">
                        <i class="bi bi-heart"></i> Yêu thích
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-9">
                <div class="card shadow-lg border-0 mb-5">
                    <div class="card-body p-5">
                        <h2 class="text-center mb-1 text-primary">@Model.Book.Title</h2>
                        <h4 class="text-center text-muted mb-4">@Model.Title</h4>
                        <hr />

                        <div class="chapter-content mt-4" style="font-size: 1.3rem; line-height: 1.8; text-align: justify;">
                            @Html.Raw(Model.Content)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>